import{_ as T,a as R}from"./index-hOj_N7CY.js";import{d as $,f as z,S as v,P as p,Z as s,l as m,o as G,y as I,z as F,u as h,c as u,Q as O,D as H,$ as L,F as A,a1 as P,a2 as V,X as E,a3 as K,_ as Z,R as ee}from"./@vue-DfSatT6k.js";import{a as J,I as te,M as U}from"./ant-design-vue-Byl92AXY.js";import"./axios-upsvKRUO.js";import"./dayjs-DoMtMbyJ.js";import"./@babel-CuAkI3ff.js";import"./vue-router-1cM073JS.js";import"./pinia-BKGl0dOm.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@ant-design-ZzcxRr5c.js";import"./@ctrl-3cdSgQbg.js";import"./lodash-es-mOee43Rj.js";import"./vue-types-B67A5qzE.js";const se=$({name:"SvgIcon",props:{prefix:{type:String,default:"icon"},name:{type:String,required:!0},color:{type:String,default:"#333"}},setup(d){return{symbolId:z(()=>`#${d.prefix}-${d.name}`)}}}),ae={"aria-hidden":"true"},oe=["href","fill"];function ne(d,e,a,r,o,n){return v(),p("svg",ae,[s("use",{href:d.symbolId,fill:d.color},null,8,oe)])}const ie=T(se,[["render",ne],["__scopeId","data-v-75a038b6"]]),re=""+new URL("logo-GK00LoYR.png",import.meta.url).href,Y="data:image/png;base64,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",X=""+new URL("logo-hide-ChP2Srgt.png",import.meta.url).href;class le{constructor(){this.user=window.houtuServeConfig.user}stopChatMessage(e){const a={url:`/v1/chat-messages/${e}/stop`,method:"post",data:JSON.stringify({user:this.user})};return R(a)}getConversations(e="",a=50){const r={url:"/v1/conversations",method:"get",params:{user:this.user,last_id:e,limit:a}};return R(r)}deleteConversation(e){const a={url:`/v1/conversations/${e}`,method:"delete",data:{user:this.user}};return R(a)}updateConversationName(e,a="",r=!1){const o={url:`/v1/conversations/${e}/name`,method:"post",data:{name:a,auto_generate:r,user:this.user}};return R(o)}}const ue=d=>{const e=new Date;e.setHours(0,0,0,0);const a=new Date(e),r=new Date(e);r.setDate(e.getDate()-1);const o=new Date(e);o.setDate(e.getDate()-(e.getDay()+6)%7);const n=new Date(o);n.setDate(o.getDate()+6);const c={today:[],yesterday:[],thisWeek:[],earlier:[]};return d.forEach(l=>{const g=new Date(l.created_at*1e3);g.setHours(0,0,0,0),g.getTime()===a.getTime()?c.today.push(l):g.getTime()===r.getTime()?c.yesterday.push(l):g>=o&&g<=n?c.thisWeek.push(l):c.earlier.push(l)}),c},de={today:"今天",yesterday:"昨天",thisWeek:"本周",earlier:"更早"},ce={class:"sidebar-menu"},he={class:"sidebar-menu"},me={class:"logo"},ve={class:"search"},pe={class:"history-list"},ge={key:0,class:"categorize-title"},ye=["onClick","onMouseover"],fe={class:"history-list-item-title"},we={class:"history-list-item-operating-button"},Ce={class:"hide-status-menu"},_e={class:"hide-menu"},Se={__name:"index",emits:["toggle","setChatTitle"],setup(d,{emit:e}){const a=new le,r=m(""),o=m(!1),n=e,c=m(""),l=m(""),g=m([]),_=m(!1),S=m(""),C=m(""),x=z(()=>ue(g.value));G(async()=>{await k();var i=document.querySelector("#ai-chat");i.addEventListener("ai-chat-aiFirstAnswer",async t=>{const b=t.detail[0],N=t.detail[1];await a.updateConversationName(b,N,!1),await k(),S.value=b,n("setChatTitle",g.value[0].name)})});const k=async()=>{const i=await a.getConversations();g.value=[...i.data],console.log(x.value)},W=i=>{l.value=i.id;var t=document.querySelector("#ai-chat");t.switchChatSessions(i.id),n("setChatTitle",i.name)},q=()=>{l.value="",n("setChatTitle","");var i=document.querySelector("#ai-chat");i.newChat()},M=()=>{n("toggle"),o.value?setTimeout(()=>{o.value=!o.value},150):o.value=!o.value},j=i=>{S.value=i.id,_.value=!0,C.value=i.name},Q=async()=>{_.value=!1,(await a.updateConversationName(S.value,C.value)).id===S.value&&(S.value="",C.value="",J.success("修改成功"),k())},B=i=>{U.confirm({title:"确认删除聊天记录?",content:"删除后，聊天记录不可恢复",okText:"确定",cancelText:"取消",onOk(){return a.deleteConversation(i).then(t=>{t.result==="success"&&(J.success("删除成功"),i===l.value&&(l.value="",q()),k())})},onCancel(){}})};return(i,t)=>{const b=te,N=U,w=ie;return v(),p("div",ce,[I(s("div",he,[u(N,{visible:h(_),"onUpdate:visible":t[1]||(t[1]=y=>H(_)?_.value=y:null),title:"编辑对话名称","cancel-text":"取消","ok-text":"确认",onOk:Q},{default:O(()=>[u(b,{value:h(C),"onUpdate:value":t[0]||(t[0]=y=>H(C)?C.value=y:null),"show-count":"",maxlength:30},null,8,["value"])]),_:1},8,["visible"]),s("div",me,[t[4]||(t[4]=s("img",{src:re},null,-1)),u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:M})]),s("div",{class:"new-chat",onClick:q},[u(w,{name:"newChat",style:{width:"22px",height:"22px"}}),t[5]||(t[5]=L(" 新建对话 "))]),s("div",ve,[u(b,{value:h(r),"onUpdate:value":t[2]||(t[2]=y=>H(r)?r.value=y:null),placeholder:"搜索历史记录",style:{height:"40px","border-radius":"8px"}},{prefix:O(()=>[u(w,{name:"search",style:{width:"16px",height:"16px"}})]),_:1},8,["value"])]),s("div",pe,[(v(!0),p(A,null,P(Object.keys(x.value),y=>(v(),p(A,{key:y},[x.value[y].length!==0?(v(),p("div",ge,V(h(de)[y]),1)):E("",!0),(v(!0),p(A,null,P(x.value[y],f=>(v(),p("div",{key:f.id,class:K(["history-list-item",{"hisory-list-item-choosed":h(l)===f.id}]),onClick:D=>W(f),onMouseover:D=>c.value=f.id,onMouseleave:t[3]||(t[3]=D=>c.value="")},[s("div",fe,V(f.name),1),I(s("div",we,[u(w,{name:"edit",onClick:Z(D=>j(f),["stop"])},null,8,["onClick"]),u(w,{name:"download"}),u(w,{name:"delete",onClick:Z(D=>B(f.id),["stop"])},null,8,["onClick"])],512),[[F,h(c)===f.id||h(l)===f.id]])],42,ye))),128))],64))),128))]),t[6]||(t[6]=s("div",{class:"sidebar-bottom"},[s("img",{src:Y}),L("用户信息 ")],-1))],512),[[F,!h(o)]]),I(s("div",Ce,[s("div",null,[t[7]||(t[7]=s("img",{src:X,style:{width:"30px",height:"30px"}},null,-1)),s("div",_e,[u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:M}),u(w,{name:"newChat",style:{width:"22px",height:"22px"},onClick:q})])]),t[8]||(t[8]=s("div",{class:"hide-user"},[s("img",{src:Y})],-1))],512),[[F,h(o)]])])}}},be=T(Se,[["__scopeId","data-v-752dc503"]]),xe={key:0,class:"chat-home-page"},ke={__name:"index",props:{showHome:{type:Boolean,default:!0}},emits:["setShowHome"],setup(d,{emit:e}){const a=e;G(()=>{r()});const r=()=>{window.DiitAiChat.register("ai-chat","/lib/chatTheme.css");var o=document.querySelector("#ai-chat");o.chatConfig={brand:{logo:"./img/logo.png",title:"聊天机器人",isShow:!1},robot:{avatar:"./img/robot.png"},user:{avatar:""},systemFirstComponent:"",messages:[{code:"system",data:{text:""}},{code:"robot",data:{text:""}}],placeholder:"",sidebar:{customComponent:null},bottomTip:"",apiConfig:{url:window.houtuServeConfig.url,apiKey:window.houtuServeConfig.apiKey,user:window.houtuServeConfig.user}},o.addEventListener("ai-chat-sendFirstChat",()=>{a("setShowHome");var n=document.querySelector("#ai-chat");n.newChat()})};return(o,n)=>{const c=ee("ai-chat");return v(),p(A,null,[d.showHome?(v(),p("div",xe,n[0]||(n[0]=[s("div",{class:"main"},[s("div",{class:"logo"},[s("img",{src:X}),L(" 国土空间基础信息平台 | 后土应用 ")]),s("div",{class:"describe"}," 作为你的智能伙伴，我既能写文案、想点子，又能陪你聊天、答疑解惑～ ")],-1)]))):E("",!0),u(c,{id:"ai-chat",class:K({"home-page":d.showHome}),style:{width:"100%"}},null,8,["class"]),n[1]||(n[1]=s("div",{class:"bottom-tip"}," 服务生成的所有内容均由人工智能模型生成，其生成内容的准确性和完整性无法保证，请注意甄别 ",-1))],64)}}},De=T(ke,[["__scopeId","data-v-dfd4d71e"]]),Re={class:"ht-app"},Ae={class:"main"},Te={key:0,class:"main-header"},qe={class:"main-view"},Ne={__name:"index",setup(d){const e=m(!0),a=m(!1),r=m(""),o=()=>{a.value=!a.value},n=l=>{e.value=!1,r.value=l},c=()=>{e.value=!1};return(l,g)=>(v(),p("div",Re,[s("div",{class:K(["sidebar",{collapsed:h(a)}])},[u(be,{onToggle:o,onSetChatTitle:n})],2),s("div",Ae,[h(e)?E("",!0):(v(),p("header",Te,V(h(r)),1)),s("main",qe,[u(De,{"show-home":h(e),onSetShowHome:c},null,8,["show-home"])])])]))}},Ye=T(Ne,[["__scopeId","data-v-1207b16d"]]);export{Ye as default};
