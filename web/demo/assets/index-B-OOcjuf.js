import{M as Y,a as b,I as ue,f as Ke,g as pe,h as me,D as Ne,i as Oe,U as Ae,j as xe,k as Ie,T as Se,_ as De,B as Ce,m as Fe,F as Me,n as Ue,o as Le,p as qe,q as Ee}from"./ant-design-vue-BIWC9lDE.js";import{_ as fe}from"./SvgIcon-DfibCmV0.js";import{h as S,c as _e,C as Re,a as ze}from"./index-DArIOQQs.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r,o as se,a0 as T,a5 as Z,c as n,a1 as t,a2 as d,G as _,u as e,H as Q,$ as C,ab as Be,e as R,aa as B,a as oe,F as Pe,a9 as Ge,a7 as Qe,w as le,k as Ve,D as Ye,a8 as Ze,Z as ie}from"./@vue-CWpNdP1s.js";import{Q as je,T as Je,V as We}from"./@ant-design-QJN1JqLk.js";import{d as ae}from"./dayjs-D_OjG5MW.js";import"./@babel-iW7uCiFE.js";import"./lodash-es-CSO40SSR.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./vue-types-B67A5qzE.js";import"./@ctrl-3cdSgQbg.js";import"./dom-align-OCOKWGcj.js";import"./async-validator-P8scd9xB.js";import"./scroll-into-view-if-needed-BYx7v0DY.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./axios-upsvKRUO.js";import"./vue-router-ue3rUI8W.js";import"./pinia-CkGp7EET.js";import"./vxe-pc-ui-D1GNyJ0s.js";import"./xe-utils-BFvWVFuP.js";import"./@vxe-ui-BjvPc2TS.js";import"./dom-zindex-DlWB42XF.js";import"./vxe-table-CUWM7qwh.js";function He(){return S.request({method:"get",url:"/api/v1/knowledge/tree",params:{}})}function Xe(i){return S.request({method:"post",url:"/api/v1/knowledge/tree/node",data:i})}function $e(i,u){return S.request({method:"put",url:`/api/v1/knowledge/tree/node/${i}`,data:u})}function et(i){return S.request({method:"delete",url:`/api/v1/knowledge/tree/node/${i}`})}function tt(i,u){return S.request({method:"get",url:`/api/v1/knowledge/file/list/${i}`,params:u})}function re(i){return S.request({method:"delete",url:"/api/v1/knowledge/file/delete",data:{ids:i}})}function de(i){return S.request({method:"post",url:"/api/v1/knowledge/file/parse/start",data:{document_ids:i}})}function ce(i){return S.request({method:"post",url:"/api/v1/knowledge/file/parse/stop",data:{document_ids:i}})}function nt(i,u){return S.request({method:"get",url:`/api/v1/knowledge/file/chunks/${i}`,params:u})}function at(i,u){return S.request({headers:{"Content-Type":"multipart/form-data"},method:"post",url:`/api/v1/knowledge/file/upload/${i}`,data:u})}function ot(i){return S.request({method:"get",url:`/api/preview/${i}`,params:{}})}const st={class:"tree-container"},lt={style:{"margin-top":"20px"}},it=["title","onClick"],rt={__name:"Tree",emits:["setSelectedTreeKey"],setup(i,{emit:u}){const g=r([]),c=r(!1),p=r(""),m=r(""),y=r(!1),w=r({}),K=r([]),f=u,L=r(_e().isAdministrator());se(async()=>{await k();const l=v(g.value);K.value=[l],f("setSelectedTreeKey",K.value[0])});const h=(l,a)=>{K.value[0]!==l[0]&&(K.value=l,f("setSelectedTreeKey",K.value[0]))},v=l=>{let a=l[0];for(;a.children.length>0;)a=a.children[0];return a.id},k=async()=>{const l=await He();g.value=[l]},N=l=>{if(w.value=l,!!l.menuKey)switch(l.menuKey){case"newNode":O();break;case"rename":q(l);break;case"delete":I();break}},O=l=>{y.value=!0,c.value=!0},I=l=>{Y.confirm({title:"确认删除该节点?",content:"删除后，节点不可恢复",okText:"确定",cancelText:"取消",onOk(){return et(w.value.id).then(()=>{b.success("删除成功"),k()})},onCancel(){}})},q=l=>{p.value=l.name,m.value=l.description,c.value=!0},P=async()=>{if(!p.value){b.warning("请输入节点名称");return}if(y.value){const l={pid:w.value.id,name:p.value,sortOrder:0,description:m.value};await Xe(l).catch(F=>{b.warning("节点名称存在重复，请重新输入")})&&(k(),b.success("新增成功"),w.value={},c.value=!1)}else{const l={name:p.value,sortOrder:w.value.sortOrder,description:m.value};await $e(w.value.id,l).catch(F=>{b.warning("节点名称存在重复，请重新输入")})&&(k(),b.success("修改成功"),w.value={},c.value=!1)}y.value=!1};return(l,a)=>{const F=ue,A=Ke,D=Y,J=fe,x=pe,X=me,$=Ne,ee=Oe;return T(),Z("div",st,[n(D,{visible:e(c),"onUpdate:visible":a[2]||(a[2]=M=>Q(c)?c.value=M:null),title:e(y)?"新增节点":"修改节点","cancel-text":"取消","ok-text":"确认",onOk:P},{default:t(()=>[d("div",null,[a[3]||(a[3]=d("span",{style:{color:"red"}},"*",-1)),a[4]||(a[4]=_("节点名称：")),n(F,{value:e(p),"onUpdate:value":a[0]||(a[0]=M=>Q(p)?p.value=M:null),placeholder:"请输入节点名称"},null,8,["value"])]),d("div",lt,[a[5]||(a[5]=_(" 节点描述:")),n(A,{value:e(m),"onUpdate:value":a[1]||(a[1]=M=>Q(m)?m.value=M:null),placeholder:"请输入节点描述",rows:4},null,8,["value"])])]),_:1},8,["visible","title"]),e(g).length?(T(),C(ee,{key:0,"tree-data":e(g),blockNode:!0,virtual:!1,fieldNames:{children:"children",title:"name",key:"id"},defaultExpandAll:!0,selectedKeys:e(K)},{title:t(({kdb_id:M,id:W,description:o,name:s,children:U,sortOrder:z})=>[n($,{trigger:["contextmenu"]},Be({default:t(()=>[d("span",{class:"node-content",title:o||s,onClick:H=>h([W])},[U&&U.length!==0?(T(),C(J,{key:0,name:"wjj",style:{width:"15px",height:"15px",display:"inline-block",position:"relative",bottom:"2px"}})):R("",!0),_(" "+B(s),1)],8,it)]),_:2},[e(L)?{name:"overlay",fn:t(()=>[n(X,{onClick:({key:H})=>N({name:s,kdb_id:M,id:W,menuKey:H,sortOrder:z,description:o})},{default:t(()=>[n(x,{key:"newNode"},{icon:t(()=>[n(e(je))]),default:t(()=>[a[6]||(a[6]=_(" 新建节点 "))]),_:1}),n(x,{key:"rename"},{icon:t(()=>[n(e(Je))]),default:t(()=>[a[7]||(a[7]=_(" 修改 "))]),_:1}),n(x,{key:"delete",danger:""},{icon:t(()=>[n(e(We))]),default:t(()=>[a[8]||(a[8]=_(" 删除 "))]),_:1})]),_:2},1032,["onClick"])]),key:"0"}:void 0]),1024)]),_:1},8,["tree-data","selectedKeys"])):R("",!0)])}}},dt=j(rt,[["__scopeId","data-v-da1a0e36"]]),ct="data:image/png;base64,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",ut={class:"upload-actions"},pt={class:"tip"},mt={__name:"UpLoadFileModal",props:{modalOpen:{type:Boolean,default:!1},selectedTreeKey:{type:String,default:""}},emits:["update:modalOpen","upload-success"],setup(i,{emit:u}){ze().get(Re.TOKEN_NAME);const c=i,p=u,m=r([]),y=r(!1),w=h=>{const v=["doc","docx","pdf","ppt","txt"],k=h.type.startsWith("image/"),N=h.name.split(".").pop().toLowerCase();return!v.includes(N)&&!k?(b.error("仅支持上传文档（doc/docx/pdf/ppt/txt）或图片文件"),!1):(m.value=[...m.value,h],!1)},K=async()=>{var v,k;if(m.value.length===0)return;y.value=!0;const h=new FormData;m.value.forEach(N=>{h.append("files",N.originFileObj)});try{await at(c.selectedTreeKey,h),b.success("上传成功"),m.value=[],f()}catch(N){b.error("上传失败: "+(((k=(v=N.response)==null?void 0:v.data)==null?void 0:k.message)||N.message))}finally{uploading.value=!1}},f=()=>{y.value=!1,p("update:modalOpen",!1)},L=()=>{p("update:modalOpen",!1)};return(h,v)=>{const k=Ae,N=Y;return T(),C(N,{style:{width:"50%"},visible:i.modalOpen,title:"上传文档","cancel-text":"取消","confirm-loading":y.value,"ok-text":"开始上传",onOk:K,onCancel:L},{default:t(()=>[n(k,{fileList:m.value,"onUpdate:fileList":v[0]||(v[0]=O=>m.value=O),name:"files",multiple:!0,accept:".doc,.docx,.pdf,.ppt,.txt,image/*","before-upload":w,onChange:h.handleChange,onDrop:h.handleDrop},{default:t(()=>v[1]||(v[1]=[d("div",{class:"ant-upload-drag-icon"},[d("img",{src:ct}),d("p",{style:{color:"#4687fe","font-weight":"600"}},"上传本地文件")],-1)])),_:1},8,["fileList","onChange","onDrop"]),d("div",ut,[d("span",pt,"已选择 "+B(m.value.length)+" 个文件",1)])]),_:1},8,["visible","confirm-loading"])}}},ft=j(mt,[["__scopeId","data-v-d89a3cda"]]),_t={class:"slice-main"},gt={class:"pdf"},vt={class:"slice-content"},yt={class:"slice-list"},wt={class:"slice-number"},ht={class:"list-main beautify-scrollbar"},kt=["onClick"],Tt={class:"seq"},bt=["innerHTML"],Kt={__name:"DetailSliceModal",props:{modalOpen:{type:Boolean,default:!1},title:{type:String,default:""},documentId:{type:String,default:""}},emits:["update:modalOpen"],setup(i,{emit:u}){const g=r("1");r(6);const c=r(""),p=r([]),m=r(""),y=r(""),w=r(null),K=i,f=oe({current:1,pageSize:10,total:50,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:O=>`共 ${O} 条`});se(async()=>{N();const O=await ot(K.documentId);y.value=O.previewUrl,w.value.contentWindow.postMessage({fileUrl:`${m.value}${y.value}`}),console.log()});const L=u,h=()=>{L("update:modalOpen",!1)},v=()=>{L("update:modalOpen",!1)},k=O=>{c.value=O.id},N=async(O={})=>{try{const I={page:f.current,limit:f.pageSize},q=await nt(K.documentId,I);f.total=q.data.total,p.value=q.data.chunks,console.log("Fetch data with params:",O)}catch{b.error("数据加载失败")}finally{}};return(O,I)=>{const q=fe,P=xe,l=Ie,a=Se,F=Y;return T(),C(F,{style:{width:"100vw",top:0,paddingBottom:0,maxWidth:"auto",margin:"0px"},bodyStyle:{height:"calc(100vh - 55px)",overflowY:"auto",padding:"0px"},visible:i.modalOpen,title:i.title,"cancel-text":"取消","ok-text":"确认",onOk:h,onCancel:v,footer:null,destroyOnClose:!0},{default:t(()=>[d("div",_t,[d("div",gt,[d("iframe",{src:"/pdf-view/index.html",ref_key:"iframe",ref:w,style:{width:"100%",height:"100%"}},null,512)]),d("div",vt,[n(a,{activeKey:e(g),"onUpdate:activeKey":I[2]||(I[2]=A=>Q(g)?g.value=A:null)},{default:t(()=>[n(l,{key:"1",tab:"段落"},{default:t(()=>[d("div",yt,[d("div",wt,[n(q,{name:"sliceNumber",style:{width:"18px",height:"18px"}}),_("段落拆分（"+B(e(f).total)+"） ",1)]),d("div",ht,[(T(!0),Z(Pe,null,Ge(e(p),(A,D)=>(T(),Z("div",{class:Qe(["list-item",{"choosed-slice":e(c)===A.id}]),key:A.id,onClick:J=>k(A)},[d("div",Tt,B(D+1<10?`0${D+1}`:D+1)+".",1),d("div",{class:"content",innerHTML:A.content},null,8,bt)],10,kt))),128))]),n(P,{current:e(f).current,"onUpdate:current":I[0]||(I[0]=A=>e(f).current=A),"page-size":e(f).pageSize,"onUpdate:pageSize":I[1]||(I[1]=A=>e(f).pageSize=A),total:e(f).total,"show-total":e(f).showTotal,showSizeChanger:e(f).showSizeChanger,pageSizeOptions:e(f).pageSizeOptions},null,8,["current","page-size","total","show-total","showSizeChanger","pageSizeOptions"])])]),_:1})]),_:1},8,["activeKey"])])])]),_:1},8,["visible","title"])}}},Nt=j(Kt,[["__scopeId","data-v-13235417"]]),Ot={class:"knowledge-table-container"},At={class:"main-content"},xt={class:"search-section"},It={class:"table-section"},St={__name:"KnowledgeTable",props:{selectedTreeKey:{type:String,required:!0}},setup(i){const u=r(_e().isAdministrator()),g=r([]);r(!1);const c=r(!1),p=r(!1),m=r(""),y=r("开始解析"),w=r("");let K=null;const f={UNSTART:"待解析",RUNNING:"解析中",CANCEL:"已取消",DONE:"已入库",FAIL:"入库失败"},L={UNSTART:"开始解析",RUNNING:"停止解析",CANCEL:"重新解析",DONE:"查看",FAIL:"重新解析"},h={UNSTART:"",RUNNING:"",CANCEL:"",DONE:"#389e0d",FAIL:"#ff4d4f"},v=i,k=()=>{c.value=!0},N=o=>{y.value=o.key};le(()=>v.selectedTreeKey,o=>{Object.assign(l,{name:""}),D.value=!1,a.current=1,x()}),le(()=>c.value,o=>{o||x()});const O=o=>{Y.confirm({title:"确认删除该文件?",content:"删除后，文件不可恢复",okText:"确定",cancelText:"取消",onOk(){return re([o.id]).then(s=>{b.success("删除成功"),x()})},onCancel(){}})},I=[{title:"文档名称",dataIndex:"name",ellipsis:!0},{title:"上传人",dataIndex:"username",width:80,ellipsis:!0},{title:"上传时间",dataIndex:"create_time",width:100,sorter:(o,s)=>ae(o.createTime)-ae(s.createTime),customRender:({text:o})=>ae(Number(o)).format("YYYY-MM-DD HH:mm:ss")},{title:"文档状态",dataIndex:"run",width:80,align:"center"},{title:"文档类型",dataIndex:"type",width:80,align:"center"},{title:"操作",dataIndex:"operation",width:150,align:"center",fixed:"right"}],q=o=>{Object.assign(a,o),x()},P=r([]),l=oe({name:""}),a=oe({current:1,pageSize:10,total:50,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:o=>`共 ${o} 条`}),F=r(!1),A=r(!1),D=r(!1);se(()=>{K=setInterval(()=>{x(!0)},5e3)}),Ve(()=>{clearInterval(K)});const J=o=>{g.value=o},x=async o=>{try{o||(F.value=!0);const s={...l,page:a.current,pageSize:a.pageSize},U=await tt(v.selectedTreeKey,s);a.total=U.data.total,P.value=U.data.docs}catch{b.error("数据加载失败")}finally{F.value=!1}},X=()=>{D.value=!0,x()},$=()=>{Object.assign(l,{name:""}),D.value=!1,x()},ee=o=>{p.value=!0,m.value=o.name,w.value=o.id},M=async()=>{const o=g.value;switch(y.value){case"开始解析":await de(o),b.success("已批量开始解析");break;case"结束解析":await ce(o),b.success("已批量结束解析");break;default:re(o).then(s=>{b.success("批量删除成功")})}g.value=[],x()},W=async o=>{const s=["UNSTART","CANCEL","FAIL"],U=["RUNNING"],z=o.run;s.includes(z)?(await de([o.id]),x()):U.includes(z)?(await ce([o.id]),x()):ee(o)};return(o,s)=>{const U=ue,z=De,H=ie("SearchOutlined"),G=Ce,ge=ie("UndoOutlined"),te=Fe,ve=Me,ne=pe,ye=me,we=Ue,he=Le,ke=qe,Te=Ee;return T(),Z("div",Ot,[n(ft,{modalOpen:e(c),"onUpdate:modalOpen":s[0]||(s[0]=E=>Q(c)?c.value=E:null),selectedTreeKey:i.selectedTreeKey},null,8,["modalOpen","selectedTreeKey"]),e(p)?(T(),C(Nt,{key:0,modalOpen:e(p),"onUpdate:modalOpen":s[1]||(s[1]=E=>Q(p)?p.value=E:null),title:e(m),documentId:e(w)},null,8,["modalOpen","title","documentId"])):R("",!0),d("div",At,[d("div",xt,[n(ve,{model:e(l),layout:"inline",class:"advanced-search-form",onSubmit:Ye(X,["prevent"])},{default:t(()=>[n(z,{label:"文档名称",class:"form-item-custom"},{default:t(()=>[n(U,{value:e(l).name,"onUpdate:value":s[2]||(s[2]=E=>e(l).name=E),placeholder:"请输入关键字进行搜索",style:{width:"200px"},"allow-clear":""},null,8,["value"])]),_:1}),n(z,{class:"form-item-custom"},{default:t(()=>[n(te,{size:16},{default:t(()=>[n(G,{"html-type":"submit",loading:e(A),type:"primary"},{icon:t(()=>[n(H)]),default:t(()=>[s[3]||(s[3]=_(" 搜索 "))]),_:1},8,["loading"]),n(G,{onClick:$,class:"main-btn"},{icon:t(()=>[n(ge)]),default:t(()=>[s[4]||(s[4]=_(" 重置 "))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),d("div",It,[n(te,{size:16,style:{"margin-bottom":"20px"}},{default:t(()=>[e(u)?(T(),C(G,{key:0,type:"primary",onClick:k},{default:t(()=>s[5]||(s[5]=[_(" 上传文档 ")])),_:1})):R("",!0),n(we,{onClick:M,type:"primary"},{overlay:t(()=>[n(ye,{onClick:N},{default:t(()=>[n(ne,{key:"开始解析"},{default:t(()=>s[6]||(s[6]=[_(" 开始解析 ")])),_:1}),n(ne,{key:"结束解析"},{default:t(()=>s[7]||(s[7]=[_(" 结束解析 ")])),_:1}),n(ne,{key:"删除"},{default:t(()=>s[8]||(s[8]=[_("删除")])),_:1})]),_:1})]),default:t(()=>[_(B(e(y))+" ",1)]),_:1})]),_:1}),n(Te,{"row-selection":{selectedRowKeys:e(g),onChange:J},columns:I,loading:e(F),"data-source":e(P),pagination:e(a),scroll:{x:500,y:"calc(100vh - 300px)"},bordered:"",size:"middle","row-key":"id",sticky:"",onChange:q},{bodyCell:t(({column:E,record:V})=>[E.dataIndex==="run"?(T(),C(G,{key:0,type:"link",size:"small",style:Ze({color:h[V.run]})},{default:t(()=>[_(B(f[V.run]),1)]),_:2},1032,["style"])):R("",!0),E.dataIndex==="operation"?(T(),C(te,{key:1,size:4},{default:t(()=>[n(G,{type:"link",size:"small",onClick:be=>W(V)},{default:t(()=>[_(B(L[V.run]),1)]),_:2},1032,["onClick"]),e(u)?(T(),C(he,{key:0,type:"vertical"})):R("",!0),e(u)?(T(),C(G,{key:1,type:"link",size:"small",style:{color:"#ea3333"},onClick:be=>O(V)},{default:t(()=>s[9]||(s[9]=[_(" 删除 ")])),_:2},1032,["onClick"])):R("",!0)]),_:2},1024)):R("",!0)]),emptyText:t(()=>[n(ke,{description:e(D)?"暂无相关数据":"暂无数据"},null,8,["description"])]),_:1},8,["row-selection","loading","data-source","pagination"])])])])}}},Dt=j(St,[["__scopeId","data-v-bd41475e"]]),Ct={class:"knowledge"},Ft={class:"tree"},Mt={id:"knowledge-table"},Ut={__name:"index",setup(i){const u=r(""),g=c=>{u.value=c};return(c,p)=>(T(),Z("div",Ct,[d("div",Ft,[n(dt,{onSetSelectedTreeKey:g})]),d("div",Mt,[n(Dt,{selectedTreeKey:e(u)},null,8,["selectedTreeKey"])])]))}},ln=j(Ut,[["__scopeId","data-v-26504267"]]);export{ln as default};
