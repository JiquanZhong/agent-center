import{_ as T,a as R}from"./index-DRmy3_1D.js";import{d as $,f as Y,S as v,P as p,Z as t,l as m,o as z,y as N,z as I,u as h,c as u,Q as M,D as F,$ as H,F as A,a1 as O,a2 as L,X as V,a3 as E,_ as P,R as ee}from"./@vue-DfSatT6k.js";import{a as Z,I as te,M as J}from"./ant-design-vue-Byl92AXY.js";import"./axios-upsvKRUO.js";import"./dayjs-DoMtMbyJ.js";import"./@babel-CuAkI3ff.js";import"./vue-router-1cM073JS.js";import"./pinia-BKGl0dOm.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./@ant-design-ZzcxRr5c.js";import"./@ctrl-3cdSgQbg.js";import"./lodash-es-mOee43Rj.js";import"./vue-types-B67A5qzE.js";const se=$({name:"SvgIcon",props:{prefix:{type:String,default:"icon"},name:{type:String,required:!0},color:{type:String,default:"#333"}},setup(c){return{symbolId:Y(()=>`#${c.prefix}-${c.name}`)}}}),oe={"aria-hidden":"true"},ae=["href","fill"];function ne(c,e,a,r,o,n){return v(),p("svg",oe,[t("use",{href:c.symbolId,fill:c.color},null,8,ae)])}const ie=T(se,[["render",ne],["__scopeId","data-v-75a038b6"]]),re=""+new URL("logo-GK00LoYR.png",import.meta.url).href,U="data:image/png;base64,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",G=""+new URL("logo-hide-ChP2Srgt.png",import.meta.url).href;class le{constructor(){this.user=window.houtuServeConfig.user}stopChatMessage(e){const a={url:`/v1/chat-messages/${e}/stop`,method:"post",data:JSON.stringify({user:this.user})};return R(a)}getConversations(e="",a=50){const r={url:"/v1/conversations",method:"get",params:{user:this.user,last_id:e,limit:a}};return R(r)}deleteConversation(e){const a={url:`/v1/conversations/${e}`,method:"delete",data:{user:this.user}};return R(a)}updateConversationName(e,a="",r=!1){const o={url:`/v1/conversations/${e}/name`,method:"post",data:{name:a,auto_generate:r,user:this.user}};return R(o)}}const ue=c=>{const e=new Date;e.setHours(0,0,0,0);const a=new Date(e),r=new Date(e);r.setDate(e.getDate()-1);const o=new Date(e);o.setDate(e.getDate()-(e.getDay()+6)%7);const n=new Date(o);n.setDate(o.getDate()+6);const d={today:[],yesterday:[],thisWeek:[],earlier:[]};return c.forEach(l=>{const g=new Date(l.created_at*1e3);g.setHours(0,0,0,0),g.getTime()===a.getTime()?d.today.push(l):g.getTime()===r.getTime()?d.yesterday.push(l):g>=o&&g<=n?d.thisWeek.push(l):d.earlier.push(l)}),d},ce={today:"今天",yesterday:"昨天",thisWeek:"本周",earlier:"更早"},de={class:"sidebar-menu"},he={class:"sidebar-menu"},me={class:"logo"},ve={class:"search"},pe={class:"history-list"},ge={key:0,class:"categorize-title"},ye=["onClick","onMouseover"],fe={class:"history-list-item-title"},we={class:"history-list-item-operating-button"},Ce={class:"hide-status-menu"},_e={class:"hide-menu"},be={__name:"index",emits:["toggle","setChatTitle"],setup(c,{emit:e}){const a=new le,r=m(""),o=m(!1),n=e,d=m(""),l=m(""),g=m([]),_=m(!1),b=m(""),C=m(""),S=Y(()=>ue(g.value));z(async()=>{await x();var i=document.querySelector("#ai-chat");i.addEventListener("ai-chat-aiFirstAnswer",async s=>{const k=s.detail[0];await x(),b.value=k,n("setChatTitle",g.value[0].name)})});const x=async()=>{const i=await a.getConversations();g.value=[...i.data],console.log(S.value)},X=i=>{l.value=i.id;var s=document.querySelector("#ai-chat");s.switchChatSessions(i.id),n("setChatTitle",i.name)},q=()=>{l.value="",n("setChatTitle","");var i=document.querySelector("#ai-chat");i.newChat()},K=()=>{n("toggle"),o.value?setTimeout(()=>{o.value=!o.value},150):o.value=!o.value},W=i=>{b.value=i.id,_.value=!0,C.value=i.name},j=async()=>{_.value=!1,(await a.updateConversationName(b.value,C.value)).id===b.value&&(b.value="",C.value="",Z.success("修改成功"),x())},Q=i=>{J.confirm({title:"确认删除聊天记录?",content:"删除后，聊天记录不可恢复",okText:"确定",cancelText:"取消",onOk(){return a.deleteConversation(i).then(s=>{s.result==="success"&&(Z.success("删除成功"),i===l.value&&(l.value="",q()),x())})},onCancel(){}})};return(i,s)=>{const k=te,B=J,w=ie;return v(),p("div",de,[N(t("div",he,[u(B,{visible:h(_),"onUpdate:visible":s[1]||(s[1]=y=>F(_)?_.value=y:null),title:"编辑对话名称","cancel-text":"取消","ok-text":"确认",onOk:j},{default:M(()=>[u(k,{value:h(C),"onUpdate:value":s[0]||(s[0]=y=>F(C)?C.value=y:null),"show-count":"",maxlength:30},null,8,["value"])]),_:1},8,["visible"]),t("div",me,[s[4]||(s[4]=t("img",{src:re},null,-1)),u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:K})]),t("div",{class:"new-chat",onClick:q},[u(w,{name:"newChat",style:{width:"22px",height:"22px"}}),s[5]||(s[5]=H(" 新建对话 "))]),t("div",ve,[u(k,{value:h(r),"onUpdate:value":s[2]||(s[2]=y=>F(r)?r.value=y:null),placeholder:"搜索历史记录",style:{height:"40px","border-radius":"8px"}},{prefix:M(()=>[u(w,{name:"search",style:{width:"16px",height:"16px"}})]),_:1},8,["value"])]),t("div",pe,[(v(!0),p(A,null,O(Object.keys(S.value),y=>(v(),p(A,{key:y},[S.value[y].length!==0?(v(),p("div",ge,L(h(ce)[y]),1)):V("",!0),(v(!0),p(A,null,O(S.value[y],f=>(v(),p("div",{key:f.id,class:E(["history-list-item",{"hisory-list-item-choosed":h(l)===f.id}]),onClick:D=>X(f),onMouseover:D=>d.value=f.id,onMouseleave:s[3]||(s[3]=D=>d.value="")},[t("div",fe,L(f.name),1),N(t("div",we,[u(w,{name:"edit",onClick:P(D=>W(f),["stop"])},null,8,["onClick"]),u(w,{name:"download"}),u(w,{name:"delete",onClick:P(D=>Q(f.id),["stop"])},null,8,["onClick"])],512),[[I,h(d)===f.id||h(l)===f.id]])],42,ye))),128))],64))),128))]),s[6]||(s[6]=t("div",{class:"sidebar-bottom"},[t("img",{src:U}),H("用户信息 ")],-1))],512),[[I,!h(o)]]),N(t("div",Ce,[t("div",null,[s[7]||(s[7]=t("img",{src:G,style:{width:"30px",height:"30px"}},null,-1)),t("div",_e,[u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:K}),u(w,{name:"newChat",style:{width:"22px",height:"22px"},onClick:q})])]),s[8]||(s[8]=t("div",{class:"hide-user"},[t("img",{src:U})],-1))],512),[[I,h(o)]])])}}},Se=T(be,[["__scopeId","data-v-bb3568cb"]]),xe={key:0,class:"chat-home-page"},ke={__name:"index",props:{showHome:{type:Boolean,default:!0}},emits:["setShowHome"],setup(c,{emit:e}){const a=e;z(()=>{r()});const r=()=>{window.DiitAiChat.register("ai-chat","/lib/chatTheme.css");var o=document.querySelector("#ai-chat");o.chatConfig={brand:{logo:"./img/logo.png",title:"聊天机器人",isShow:!1},robot:{avatar:"./img/robot.png"},user:{avatar:""},systemFirstComponent:"",messages:[{code:"system",data:{text:""}},{code:"robot",data:{text:""}}],placeholder:"",sidebar:{customComponent:null},bottomTip:"",apiConfig:{url:window.houtuServeConfig.url,apiKey:window.houtuServeConfig.apiKey,user:window.houtuServeConfig.user}},o.addEventListener("ai-chat-sendFirstChat",()=>{a("setShowHome");var n=document.querySelector("#ai-chat");n.newChat()})};return(o,n)=>{const d=ee("ai-chat");return v(),p(A,null,[c.showHome?(v(),p("div",xe,n[0]||(n[0]=[t("div",{class:"main"},[t("div",{class:"logo"},[t("img",{src:G}),H(" 国土空间基础信息平台 | 后土应用 ")]),t("div",{class:"describe"}," 作为你的智能伙伴，我既能写文案、想点子，又能陪你聊天、答疑解惑～ ")],-1)]))):V("",!0),u(d,{id:"ai-chat",class:E({"home-page":c.showHome}),style:{width:"100%"}},null,8,["class"]),n[1]||(n[1]=t("div",{class:"bottom-tip"}," 服务生成的所有内容均由人工智能模型生成，其生成内容的准确性和完整性无法保证，请注意甄别 ",-1))],64)}}},De=T(ke,[["__scopeId","data-v-dfd4d71e"]]),Re={class:"ht-app"},Ae={class:"main"},Te={key:0,class:"main-header"},qe={class:"main-view"},Ne={__name:"index",setup(c){const e=m(!0),a=m(!1),r=m(""),o=()=>{a.value=!a.value},n=l=>{e.value=!1,r.value=l},d=()=>{e.value=!1};return(l,g)=>(v(),p("div",Re,[t("div",{class:E(["sidebar",{collapsed:h(a)}])},[u(Se,{onToggle:o,onSetChatTitle:n})],2),t("div",Ae,[h(e)?V("",!0):(v(),p("header",Te,L(h(r)),1)),t("main",qe,[u(De,{"show-home":h(e),onSetShowHome:d},null,8,["show-home"])])])]))}},Ye=T(Ne,[["__scopeId","data-v-1207b16d"]]);export{Ye as default};
