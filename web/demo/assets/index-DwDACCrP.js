import{_ as C,E,v as F}from"./ant-design-vue--Wr84Izy.js";import{_ as M}from"./SvgIcon-D33RiJgU.js";import{r as s,o as D,n as L,y as V,w as x,a0 as w,a5 as k,a as $,a2 as d,c as h,a1 as R,a7 as g,u as p,F as H,a8 as K,v as z,B as N,H as O,a9 as U}from"./@vue-B5btswkz.js";import{g as W,k as q}from"./knowledge-4fmUvZpN.js";import{b as j,e as S}from"./index-BsLPKckO.js";import{i as G}from"./echarts-BMamZ_Rz.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./@babel-Dd5QU_Ri.js";import"./@ant-design-B-ejxF28.js";import"./@ctrl-3cdSgQbg.js";import"./lodash-es-CSO40SSR.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./dayjs-bdfbxlhH.js";import"./vue-types-B67A5qzE.js";import"./dom-align-OCOKWGcj.js";import"./async-validator-P8scd9xB.js";import"./scroll-into-view-if-needed-BYx7v0DY.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./axios-upsvKRUO.js";import"./vue-router-D8gsG8iB.js";import"./pinia-DuIsOk5z.js";import"./vxe-pc-ui-B3rMWPmo.js";import"./xe-utils-BVyeMf_3.js";import"./@vxe-ui-ivSiCnOc.js";import"./dom-zindex-DlWB42XF.js";import"./vxe-table-CY8UZVkh.js";import"./tslib-BDyQ-Jie.js";import"./zrender-CaXuXc8i.js";const I={__name:"DonutChart",props:{charts:{type:Array,required:!0}},setup(b){const _=j();debugger;const i=b,r=s(null);let o=null;const u=()=>{if(!r.value||i.charts.length!==4)return;o=G(r.value);const m=[["12.5%","35%"],["37.5%","35%"],["62.5%","35%"],["87.5%","35%"]],v=i.charts.map((t,e)=>({name:t.title,type:"pie",radius:["30%","40%"],center:m[e],label:{show:!0,position:"outside",formatter:`{b}
{c}`+t.unit+" ({d}%)",fontSize:10,color:"#666"},labelLine:{show:!0,length:5,length2:3,lineStyle:{color:"#aaa"}},data:t.data.map(l=>({...l,itemStyle:{color:l.color}}))})),f=i.charts.map((t,e)=>({text:`{a|${t.title}}

{b|${t.total}${t.unit}}`,left:m[e][0],top:m[e][1],textAlign:"center",textVerticalAlign:"middle",textStyle:{rich:{a:{fontSize:12,color:"#333",fontWeight:"bold"},b:{fontSize:14,fontWeight:"bold",color:"#333"}}}})),y=Array.from(new Set(i.charts.flatMap(t=>t.data.map(e=>e.name)))),n={title:f,legend:{show:!0,orient:"horizontal",bottom:0,left:"center",data:y},tooltip:{trigger:"item",formatter:"{a} - {b}: {c} ({d}%)"},series:v};o.setOption(n)};D(()=>{L(()=>{u(),window.addEventListener("resize",a)})}),V(()=>{window.removeEventListener("resize",a),o==null||o.dispose()}),x(()=>i.charts,u,{deep:!0}),x(()=>_.menuStatus,m=>{a()});const a=()=>{o==null||o.resize()};return(m,v)=>(w(),k("div",{ref_key:"chartRef",ref:r,class:"w-full h-full"},null,512))}},J=B(I,[["__scopeId","data-v-d2745a52"]]),P={class:"knowledge-all-view"},Q={id:"data-table"},X={style:{"font-size":"18px"}},Y={class:"data-block"},Z={class:"icon"},tt={class:"data"},et={class:"title"},ot={class:"num"},at={class:"data-chart"},nt={__name:"index",setup(b){const _=s("全部");s([]),s([]);const i=s([]),r=s(!0);$({current:1,pageSize:10,total:50,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:n=>`共 ${n} 条`});const o=s({id:"",name:"全部"}),u=s([{id:"file",icon:"fileNum",title:"文档总数",num:"1",color:"#8ba8ff",unit:"个"},{id:"rl",icon:"rl",title:"存储容量",num:"2",color:"#7AAAF8",unit:"MB"},{id:"token",icon:"token",title:"词元(token)总数",num:"4",color:"#7FD4ED",unit:"个"},{id:"wbk",icon:"wbk",title:"文本块总数",num:"3",color:"#FBBD77",unit:"段"}]),a=s([{title:"文档",unit:"个",total:"",id:"documentNum",data:[]},{id:"documentSize",title:"存储容量",total:"",unit:"MB",data:[]},{id:"tokenNum",title:"token",total:"",unit:"个",data:[]},{id:"chunkNum",title:"文本块",total:"",unit:"段",data:[]}]);D(async()=>{await v(),m(i.value)});const m=n=>{o.value=n[0],f(o.value.id)},v=async()=>{const n=await W();i.value=[n]},f=async n=>{const t=await q(n);u.value[0].num=t.documentNum,u.value[1].num=S(t.documentSize),u.value[2].num=t.tokenNum,u.value[3].num=t.chunkNum,a.value.forEach(e=>{e.data=[]});debugger;t.children.length===0?r.value=!1:(r.value=!0,t.children.forEach(e=>{const l=e.name;a.value[0].data.push({value:e.documentNum,name:l}),a.value[1].data.push({value:S(e.documentSize),name:l}),a.value[2].data.push({value:e.tokenNum,name:l}),a.value[3].data.push({value:e.chunkNum,name:l}),a.value[0].total=t.documentNum,a.value[1].total=S(t.documentSize),a.value[2].total=t.tokenNum,a.value[3].total=t.chunkNum}))},y=(n,t)=>{o.value={id:n,name:t[0]},f(o.value.id)};return(n,t)=>{const e=E,l=C,T=M,A=F;return w(),k("div",P,[d("div",Q,[h(l,{label:"文件目录节点：",name:"文件目录节点"},{default:R(()=>[h(e,{value:p(_),"onUpdate:value":t[0]||(t[0]=c=>O(_)?_.value=c:null),replaceFields:{children:"children",label:"name",key:"id",value:"id"},"show-search":"",style:{width:"300px"},"dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择","allow-clear":"","tree-default-expand-all":"","tree-data":p(i),"tree-node-filter-prop":"name",onChange:y},null,8,["value","tree-data"])]),_:1})]),d("h1",X,g(p(o).name),1),d("div",Y,[(w(!0),k(H,null,K(p(u),c=>(w(),k("div",{class:"data-block-item",key:c.id,style:U({background:c.color})},[d("div",Z,[h(T,{name:c.icon,style:{width:"25px",height:"25px"}},null,8,["name"])]),d("div",tt,[d("div",et,g(c.title),1),d("div",ot,g(c.num)+g(c.unit),1)])],4))),128))]),d("div",at,[z(h(J,{charts:p(a)},null,8,["charts"]),[[N,p(r)]]),z(h(A,{description:"暂无可统计的子节点数据"},null,512),[[N,!p(r)]])])])}}},Ft=B(nt,[["__scopeId","data-v-0d43ff10"]]);export{Ft as default};
