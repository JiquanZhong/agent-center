import{a as P,I as te,M as J,c as se}from"./ant-design-vue-lLteqsNy.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as oe,j as G,Y as g,a4 as y,_ as t,r as v,o as j,t as I,A as F,u as r,c as u,Z as _,G as H,E as V,F as T,a5 as U,a6 as E,a1 as L,a7 as M,B as Y,a2 as ae}from"./@vue-DmgUcenb.js";import{b as R,c as ne}from"./index-DYEg1jU3.js";import"./@babel-CMLFsLIC.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./lodash-es-DTyaW6b9.js";import"./async-validator-P8scd9xB.js";import"./@ant-design-CiE_apjx.js";import"./@ctrl-3cdSgQbg.js";import"./scroll-into-view-if-needed-BYx7v0DY.js";import"./compute-scroll-into-view-1gs_hJI2.js";import"./dayjs-BkTfh5k6.js";import"./vue-types-B67A5qzE.js";import"./dom-align-OCOKWGcj.js";import"./axios-upsvKRUO.js";import"./vue-router-BcX7TDOB.js";import"./pinia-yTvWfV_M.js";const ie=oe({name:"SvgIcon",props:{prefix:{type:String,default:"icon"},name:{type:String,required:!0},color:{type:String,default:"#333"}},setup(h){return{symbolId:G(()=>`#${h.prefix}-${h.name}`)}}}),re={"aria-hidden":"true"},le=["href","fill"];function ue(h,s,o,l,n,a){return g(),y("svg",re,[t("use",{href:h.symbolId,fill:h.color},null,8,le)])}const ce=q(ie,[["render",ue],["__scopeId","data-v-75a038b6"]]),de=""+new URL("logo-DkbGtkiM.png",import.meta.url).href,z="data:image/png;base64,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",W=""+new URL("logo-hide-ChP2Srgt.png",import.meta.url).href;class me{constructor(){this.user=window.houtuServeConfig.user}stopChatMessage(s){const o={url:`/v1/chat-messages/${s}/stop`,method:"post",data:JSON.stringify({user:this.user})};return R(o)}getConversations(s="",o=50){const l={url:"/v1/conversations",method:"get",params:{user:this.user,last_id:s,limit:o}};return R(l)}deleteConversation(s){const o={url:`/v1/conversations/${s}`,method:"delete",data:{user:this.user}};return R(o)}updateConversationName(s,o="",l=!1){const n={url:`/v1/conversations/${s}/name`,method:"post",data:{name:o,auto_generate:l,user:this.user}};return R(n)}}const he=h=>{const s=new Date;s.setHours(0,0,0,0);const o=new Date(s),l=new Date(s);l.setDate(s.getDate()-1);const n=new Date(s);n.setDate(s.getDate()-(s.getDay()+6)%7);const a=new Date(n);a.setDate(n.getDate()+6);const c={today:[],yesterday:[],thisWeek:[],earlier:[]};return h.forEach(p=>{const d=new Date(p.created_at*1e3);d.setHours(0,0,0,0),d.getTime()===o.getTime()?c.today.push(p):d.getTime()===l.getTime()?c.yesterday.push(p):d>=n&&d<=a?c.thisWeek.push(p):c.earlier.push(p)}),c},pe={today:"今天",yesterday:"昨天",thisWeek:"本周",earlier:"更早"},ve={class:"sidebar-menu"},ge={class:"sidebar-menu"},ye={class:"logo"},fe={class:"search"},we={class:"history-list"},Ce={key:0,class:"categorize-title"},_e=["onClick","onMouseover"],be={class:"history-list-item-title"},Se={class:"history-list-item-operating-button"},ke={class:"hide-status-menu"},xe={class:"hide-menu"},De={__name:"index",emits:["toggle","setChatTitle"],setup(h,{emit:s}){const{logout:o}=ne(),l=new me,n=v(""),a=v(!1),c=s,p=v(""),d=v(""),S=v([]),b=v(!1),k=v(""),C=v(""),x=G(()=>he(S.value));j(async()=>{await D();var i=document.querySelector("#ai-chat");i.addEventListener("ai-chat-aiFirstAnswer",async e=>{await D(),d.value=S.value[0].id,c("setChatTitle",S.value[0].name)})});const D=async()=>{const i=await l.getConversations();S.value=[...i.data],console.log(x.value)},X=i=>{d.value=i.id;var e=document.querySelector("#ai-chat");e.switchChatSessions(i.id),c("setChatTitle",i.name)},N=()=>{d.value="",c("setChatTitle","");var i=document.querySelector("#ai-chat");i.newChat()},K=()=>{c("toggle"),a.value?setTimeout(()=>{a.value=!a.value},150):a.value=!a.value},B=i=>{k.value=i.id,b.value=!0,C.value=i.name},Q=async()=>{b.value=!1,(await l.updateConversationName(k.value,C.value)).id===k.value&&(k.value="",C.value="",P.success("修改成功"),D())},$=i=>{J.confirm({title:"确认删除聊天记录?",content:"删除后，聊天记录不可恢复",okText:"确定",cancelText:"取消",onOk(){return l.deleteConversation(i).then(e=>{e.result==="success"&&(P.success("删除成功"),i===d.value&&(d.value="",N()),D())})},onCancel(){}})};return(i,e)=>{const O=te,ee=J,w=ce,Z=se;return g(),y("div",ve,[I(t("div",ge,[u(ee,{visible:r(b),"onUpdate:visible":e[1]||(e[1]=m=>H(b)?b.value=m:null),title:"编辑对话名称","cancel-text":"取消","ok-text":"确认",onOk:Q},{default:_(()=>[u(O,{value:r(C),"onUpdate:value":e[0]||(e[0]=m=>H(C)?C.value=m:null),"show-count":"",maxlength:30},null,8,["value"])]),_:1},8,["visible"]),t("div",ye,[e[6]||(e[6]=t("img",{src:de},null,-1)),u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:K})]),t("div",{class:"new-chat",onClick:N},[u(w,{name:"newChat",style:{width:"22px",height:"22px"}}),e[7]||(e[7]=V(" 新建对话 "))]),t("div",fe,[u(O,{value:r(n),"onUpdate:value":e[2]||(e[2]=m=>H(n)?n.value=m:null),placeholder:"搜索历史记录",style:{height:"40px","border-radius":"8px"}},{prefix:_(()=>[u(w,{name:"search",style:{width:"16px",height:"16px"}})]),_:1},8,["value"])]),t("div",we,[(g(!0),y(T,null,U(Object.keys(x.value),m=>(g(),y(T,{key:m},[x.value[m].length!==0?(g(),y("div",Ce,E(r(pe)[m]),1)):L("",!0),(g(!0),y(T,null,U(x.value[m],f=>(g(),y("div",{key:f.id,class:M(["history-list-item",{"hisory-list-item-choosed":r(d)===f.id}]),onClick:A=>X(f),onMouseover:A=>p.value=f.id,onMouseleave:e[3]||(e[3]=A=>p.value="")},[t("div",be,E(f.name),1),I(t("div",Se,[u(w,{name:"edit",onClick:Y(A=>B(f),["stop"])},null,8,["onClick"]),u(w,{name:"download"}),u(w,{name:"delete",onClick:Y(A=>$(f.id),["stop"])},null,8,["onClick"])],512),[[F,r(p)===f.id||r(d)===f.id]])],42,_e))),128))],64))),128))]),u(Z,{title:"",trigger:"click",placement:"right"},{content:_(()=>[t("div",{class:"login-out",onClick:e[4]||(e[4]=(...m)=>r(o)&&r(o)(...m))},"注销")]),default:_(()=>[e[8]||(e[8]=t("div",{class:"sidebar-bottom"},[t("img",{src:z}),V("用户信息 ")],-1))]),_:1})],512),[[F,!r(a)]]),I(t("div",ke,[t("div",null,[e[9]||(e[9]=t("img",{src:W,style:{width:"30px",height:"30px"}},null,-1)),t("div",xe,[u(w,{name:"sidebar",style:{width:"22px",height:"22px",cursor:"pointer"},onClick:K}),u(w,{name:"newChat",style:{width:"22px",height:"22px"},onClick:N})])]),u(Z,{title:"",trigger:"click",placement:"right"},{content:_(()=>[t("div",{class:"login-out",onClick:e[5]||(e[5]=(...m)=>r(o)&&r(o)(...m))},"注销")]),default:_(()=>[e[10]||(e[10]=t("div",{class:"hide-user",style:{cursor:"pointer"}},[t("img",{src:z})],-1))]),_:1})],512),[[F,r(a)]])])}}},Ae=q(De,[["__scopeId","data-v-fa72f458"]]),Re={key:0,class:"chat-home-page"},Te={__name:"index",props:{showHome:{type:Boolean,default:!0}},emits:["setShowHome"],setup(h,{emit:s}){const o=s;j(()=>{l()});const l=()=>{window.DiitAiChat.register("ai-chat","/lib/chatTheme.css");var n=document.querySelector("#ai-chat");n.chatConfig={mode:"complex",brand:{logo:"./img/logo.png",title:"聊天机器人",isShow:!1},robot:{avatar:"./img/robot.png"},user:{avatar:""},systemFirstComponent:"",messages:[{code:"system",data:{text:""}},{code:"robot",data:{text:""}}],placeholder:"",sidebar:{customComponent:null},bottomTip:"",apiConfig:{url:window.houtuServeConfig.url,apiKey:window.houtuServeConfig.apiKey,user:window.houtuServeConfig.user}},n.addEventListener("ai-chat-sendFirstChat",()=>{o("setShowHome");var a=document.querySelector("#ai-chat");a.newChat()})};return(n,a)=>{const c=ae("ai-chat");return g(),y(T,null,[h.showHome?(g(),y("div",Re,a[0]||(a[0]=[t("div",{class:"main"},[t("div",{class:"logo"},[t("img",{src:W}),V(" 国土空间基础信息平台 | 后土应用 ")]),t("div",{class:"describe"}," 作为你的智能伙伴，我既能写文案、想点子，又能陪你聊天、答疑解惑～ ")],-1)]))):L("",!0),u(c,{id:"ai-chat",class:M({"home-page":h.showHome}),style:{width:"100%"}},null,8,["class"]),a[1]||(a[1]=t("div",{class:"bottom-tip"}," 服务生成的所有内容均由人工智能模型生成，其生成内容的准确性和完整性无法保证，请注意甄别 ",-1))],64)}}},qe=q(Te,[["__scopeId","data-v-c698a1d0"]]),Ne={class:"ht-app"},Ie={class:"main"},Fe={key:0,class:"main-header"},He={class:"main-view"},Ve={__name:"index",setup(h){const s=v(!0),o=v(!1),l=v(""),n=()=>{o.value=!o.value},a=p=>{s.value=!1,l.value=p},c=()=>{s.value=!1};return(p,d)=>(g(),y("div",Ne,[t("div",{class:M(["sidebar",{collapsed:r(o)}])},[u(Ae,{onToggle:n,onSetChatTitle:a})],2),t("div",Ie,[r(s)?L("",!0):(g(),y("header",Fe,E(r(l)),1)),t("main",He,[u(qe,{"show-home":r(s),onSetShowHome:c},null,8,["show-home"])])])]))}},et=q(Ve,[["__scopeId","data-v-1207b16d"]]);export{et as default};
