(this["webpackJsonpMyLibrary"]=this["webpackJsonpMyLibrary"]||[]).push([["pers"],{48491:function(e,t,a){"use strict";a("d6a4")},"59f5":function(e,t,a){"use strict";a.r(t);a("b0c0");var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"pers-container"},[t("SystemList",{ref:"persList",attrs:{title:"用户管理",columns:e.persColumns,buttons:e.persButtons,render:e.$bpmSystemProServices.persService.getAllUser,params:e.persParams,pagination:!1,type:"radio"},on:{change:e.onPerListChange,rowClick:e.onPerRowClick,rowDbClick:e.onPerRowDbClick}},[t("template",{slot:"search-box-title"},[t("a-form",{attrs:{layout:"inline",model:e.persParams}},[t("a-form-item",{attrs:{label:"用户状态"}},[t("a-select",{staticStyle:{width:"120px"},on:{change:e.reloadPers},model:{value:e.persParams.status,callback:function(t){e.$set(e.persParams,"status",t)},expression:"persParams.status"}},[t("a-select-option",{key:"empty",attrs:{value:""}},[e._v(" 全部 ")]),e._l(e.persStatus,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])}))],2)],1),t("a-form-item",{attrs:{label:"账号名"}},[t("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入账号名","enter-button":"",allowClear:!0},on:{search:e.reloadPers},model:{value:e.persParams.loginName,callback:function(t){e.$set(e.persParams,"loginName",t)},expression:"persParams.loginName"}})],1),t("a-form-item",{attrs:{label:"真实姓名"}},[t("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入真实姓名","enter-button":"",allowClear:!0},on:{search:e.reloadPers},model:{value:e.persParams.name,callback:function(t){e.$set(e.persParams,"name",t)},expression:"persParams.name"}})],1)],1)],1)],2),t("AddPer",{attrs:{visible:e.addPerVisible,editData:e.editItemData,type:e.openPerType},on:{"update:visible":function(t){e.addPerVisible=t},"update:editData":function(t){e.editItemData=t},"update:edit-data":function(t){e.editItemData=t},submit:e.onPerSubmit}})],1)},n=[],i=a("c14f"),s=a("1da1"),o=(a("4de4"),a("a9e3"),a("b64b"),a("d3b7"),a("d8b8")),c=a("70c1"),l={name:"Pers",created:function(){this.getPersStatus(),this.getPersPost(),this.getSF(),this.getGender()},data:function(){var e=this,t=this;return{depts:[],departmentId:"",changeDeptVisible:!1,replaceFields:{title:"name",key:"id",value:"id"},persColumns:[{title:"序号",width:80,align:"center",customRender:function(e,t,a){return"".concat(a+1)}},{title:"账号名",dataIndex:"loginName",ellipsis:!0,width:140,align:"center"},{title:"真实姓名",dataIndex:"name",ellipsis:!0,width:160,align:"center"},{title:"性别",dataIndex:"sex",width:80,align:"center",customRender:function(t){var a=e.gender.filter((function(e){return e.code===t}));return a.length>0?a[0].name:""}},{title:"用户状态",dataIndex:"status",align:"center",width:80,customRender:function(e){var a=t.persStatus.filter((function(t){return t.code===e}));return a.length>0?a[0].name:""}},{title:"出生日期",dataIndex:"bornDate",align:"center",width:140},{title:"移动电话",dataIndex:"phone",align:"center",width:140},{title:"座机电话",dataIndex:"tel",align:"center",width:140},{title:"电子邮箱",dataIndex:"email",align:"center",width:140},{title:"创建时间",dataIndex:"createTime",width:180}],persButtons:[{id:1,text:"新增",icon:"iconfont-New",click:function(){t.editData?(t.editItemData={departmentId:"",sx:Number(t.editData.usernum)+1},t.openPerType="",t.addPerVisible=!0):t.$message.warning("请选择部门！")}},{id:2,text:"编辑",icon:"iconfont-Editor",click:function(){t.editItemData=t.$refs.persList.getSelected()||{},Object.keys(t.editItemData).length>0?(t.openPerType="edit",t.addPerVisible=!0):t.$message.warning("请选择一条记录！")}},{id:3,text:"删除",icon:"iconfont-Delete",click:function(){t.editItemData=t.$refs.persList.getSelected()||{},Object.keys(t.editItemData).length>0?t.$confirm({title:"提示",content:"确定移除人员?",okText:"确认",cancelText:"取消",onOk:function(){t.$bpmSystemProServices.persService.deletePers({ids:t.editItemData.id}).then((function(e){e?(t.$message.success("删除成功"),t.$refs.persList.clearSelected(),t.reloadPers()):t.$message.error("删除失败")}))},onCancel:function(){}}):t.$message.warning("请选择一条记录！")}},{id:7,text:"重置密码",icon:"iconfont-reset",click:function(){t.editItemData=t.$refs.persList.getSelected()||{},Object.keys(t.editItemData).length>0?t.$bpmSystemProServices.persService.resetPassword({userId:t.editItemData.id}).then((function(e){e?t.$message.success("重置密码成功！"):t.$message.error("重置密码失败！")})):t.$message.warning("请选择人员！")}}],persStatus:[],persPost:[],sf:[],gender:[],persParams:{status:"",name:"",loginName:""},addDeptVisible:!1,editData:{},openDeptType:"",addPerVisible:!1,editItemData:{},openPerType:"",currentRow:{},changeRow:{},selectedRowKeys:[],setSsldVisible:!1}},methods:{getPersStatus:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("YHZT");case 1:a=t.v,e.persStatus=a;case 2:return t.a(2)}}),t)})))()},getPersPost:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("ZW");case 1:a=t.v,e.persPost=a;case 2:return t.a(2)}}),t)})))()},getSF:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("SF");case 1:a=t.v,e.sf=a;case 2:return t.a(2)}}),t)})))()},getGender:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("SEX");case 1:a=t.v,e.gender=a;case 2:return t.a(2)}}),t)})))()},reloadPers:function(){this.$refs.persList.getListData()},onPerRowClick:function(e){this.editItemData=e},onPerRowDbClick:function(e){this.editItemData=e,this.openPerType="edit",this.addPerVisible=!0},onPerListChange:function(e,t,a,r){r.currentDataSource;this.pagination.pageIndex=e.current,this.reloadPers()},onPerSubmit:function(){this.reloadPers()}},components:{SystemList:o["a"],AddPer:c["default"]}},u=l,m=(a("48491"),a("2877")),d=Object(m["a"])(u,r,n,!1,null,"cc87f45a",null);t["default"]=d.exports},"70c1":function(e,t,a){"use strict";a.r(t);a("b0c0");var r=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,visible:e.visible,okText:"确定",cancelText:"取消",centered:"",confirmLoading:e.spinning,width:"50%"},on:{"update:visible":function(t){e.visible=t},ok:e.handleOk,cancel:e.handleCancel}},[t("a-spin",{attrs:{spinning:e.spinning}},[t("a-form-model",{ref:"form",attrs:{model:e.formData,rules:e.rules,layout:"horizontal","label-col":{span:8},"wrapper-col":{span:16}}},[t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"账号名",prop:"loginName"}},[t("a-input",{model:{value:e.formData.loginName,callback:function(t){e.$set(e.formData,"loginName",t)},expression:"formData.loginName"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"真实姓名",prop:"name"}},[t("a-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"性别",prop:"sex"}},[t("a-select",{model:{value:e.formData.sex,callback:function(t){e.$set(e.formData,"sex",t)},expression:"formData.sex"}},e._l(e.gender,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])})),1)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"出生日期",prop:"bornDate"}},[t("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},model:{value:e.formData.bornDate,callback:function(t){e.$set(e.formData,"bornDate",t)},expression:"formData.bornDate"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"座机电话",prop:"tel"}},[t("a-input",{model:{value:e.formData.tel,callback:function(t){e.$set(e.formData,"tel",t)},expression:"formData.tel"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"移动电话",prop:"phone"}},[t("a-input",{model:{value:e.formData.phone,callback:function(t){e.$set(e.formData,"phone",t)},expression:"formData.phone"}})],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"用户邮箱",prop:"email"}},[t("a-input",{model:{value:e.formData.email,callback:function(t){e.$set(e.formData,"email",t)},expression:"formData.email"}})],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"用户状态",prop:"status"}},[t("a-select",{model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},e._l(e.persStatus,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])})),1)],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"职务",prop:"zw"}},[t("a-select",{model:{value:e.formData.zw,callback:function(t){e.$set(e.formData,"zw",t)},expression:"formData.zw"}},[t("a-select-option",{attrs:{value:""}},[e._v("无")]),e._l(e.zw,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])}))],2)],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"职级",prop:"zj"}},[t("a-select",{model:{value:e.formData.zj,callback:function(t){e.$set(e.formData,"zj",t)},expression:"formData.zj"}},[t("a-select-option",{attrs:{value:""}},[e._v("无")]),e._l(e.zj,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.code}},[e._v(" "+e._s(a.name)+" ")])}))],2)],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"签名",prop:"remark","label-col":{span:8},"wrapper-col":{span:16}}},[e.formData.id?e._e():t("span",{staticStyle:{color:"red","margin-right":"10px"}},[e._v("请先保存人员信息再上传签名!")]),e.formData.signFspath?t("img",{staticStyle:{height:"32px","margin-right":"15px"},attrs:{alt:"",src:e.imgUrl}}):e._e(),t("a-button",{attrs:{disabled:!e.formData.id,type:"primary"},on:{click:e.uploadQm}},[e._v("上传")])],1)],1),t("a-col",{attrs:{span:12}},[t("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"头像",prop:"remark","label-col":{span:8},"wrapper-col":{span:16}}},[e.formData.id?e._e():t("span",{staticStyle:{color:"red","margin-right":"10px"}},[e._v("请先保存人员信息再上传头像!")]),e.formData.signFspath?t("img",{staticStyle:{height:"32px","margin-right":"15px"},attrs:{alt:"",src:""}}):e._e(),t("a-button",{attrs:{disabled:!e.formData.id,type:"primary"},on:{click:e.uploadQm}},[e._v("上传")])],1)],1)],1),t("a-row",{attrs:{gutter:16}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"备注",prop:"remark","label-col":{span:4},"wrapper-col":{span:20}}},[t("a-textarea",{attrs:{placeholder:"备注","auto-size":{minRows:3,maxRows:5}},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1)],1)],1)],1)],1)},n=[],i=a("c14f"),s=a("1da1");a("99af");function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c=a("a38e");function l(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Object(c["a"])(r.key),r)}}function u(e,t,a){return t&&l(e.prototype,t),a&&l(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}a("a9e3"),a("ac1f");var m=function(){function e(){o(this,e)}return u(e,null,[{key:"validateIDCard",value:function(e){var t=/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/;return t.test(e)}},{key:"validateEmail",value:function(e){var t=/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/;return t.test(e)}},{key:"validateZipCode",value:function(e){var t=/^[0-9]{6}$/;return t.test(e)}},{key:"validatePhoneNum",value:function(e){var t=/^((0\d{2,3}-\d{7,8})|(\d{7,8})|(1[35784]\d{9}))$/;return t.test(e)}},{key:"validateFixedPhoneAreaCode",value:function(e){var t=/^((0\d{2,3}-\d{7,8}(-\d{3,})?)|(\d{7,8}(-\d{3,})?))$/;return t.test(e)}},{key:"validateFixedPhoneExtension",value:function(e){var t=/^((0\d{2,3}-\d{7,8}(-\d{3,})?)|(\d{7,8}(-\d{3,})?))$/;return t.test(e)}},{key:"validateAreaCode",value:function(e){var t=/^0\d{2,3}$/;return t.test(e)}},{key:"validateFixedPhone",value:function(e){var t=/^(\d{7,8})$/;return t.test(e)}},{key:"validateMobilePhone",value:function(e){var t=/^1\d{10}$/;return t.test(e)}},{key:"validatePassword",value:function(e){var t=/^(\w){8,16}$/;return t.test(e)}},{key:"validateUsername",value:function(e){var t=/^[a-zA-Z0-9]{2,30}$/;return t.test(e)}},{key:"validateSocialCode",value:function(e){var t=/^(11|12|13|19|51|52|53|59|91|92|93|Y1)\d{6}\w{9}\w$/;return t.test(e)}},{key:"validateNeqZero",value:function(e){return isNaN(e)||0===Number(e)}},{key:"validateGtZero",value:function(e){return isNaN(e)||Number(e)<=0}},{key:"validateGteZero",value:function(e){return isNaN(e)||Number(e)<0}},{key:"validateLtZero",value:function(e){return isNaN(e)||Number(e)>=0}},{key:"validateLteZero",value:function(e){return isNaN(e)||Number(e)>0}}])}(),d=m,p=a("c466"),f=a("bc3a"),v=a.n(f),h={name:"AddPers",props:{visible:{type:Boolean,default:!1,required:!0},editData:{type:Object,required:!1,default:function(){return{}}},type:{type:String,default:"",required:!1}},created:function(){this.getPersStatus(),this.getZw(),this.getZj(),this.getSf(),this.getGender()},data:function(){var e=this;return{persStatus:[],sf:[],zw:[],gender:[],zj:[],spinning:!1,formData:{departmentId:"",password:"",id:"",name:"",sex:"",tel:"",phone:"",loginName:"",status:"",zw:"",sffzr:"",cjgzsj:"",rzsj:"",sx:"",signFpath:"",signFspath:"",remark:"",zj:"",bornDate:"",email:"",createTime:""},rules:{loginName:[{validator:function(t,a,r){e.formData.id?r():e.$bpmSystemProServices.persService.validateLoginName({loginName:a,id:e.formData.id}).then((function(e){0!==e&&"0"!==e?r(new Error("账号已存在")):r()}))},trigger:"blur"},{required:!0,message:"请输入账号"}],sffzr:[{validator:function(t,a,r){"1"===a?e.$bpmSystemProServices.persService.validateManager({departmentId:e.formData.departmentId}).then((function(e){e>0?r(new Error("该部门负责人已存在")):r()})):r()}}],name:[{required:!0,message:"请输入姓名"}],phone:[{validator:function(e,t,a){var r=d.validateMobilePhone(t);r||""===t?a():a(new Error("请输入11位手机号码"))}}],cjgzsj:[{required:!1,message:"请输入参加工作时间"}],status:[{required:!0,message:"请选择员工状态"}]}}},watch:{visible:function(e){var t=this;e?this.$nextTick((function(){t.resetFormData(),t.formData=Object.assign(t.formData,t.editData),"edit"!==t.type&&(t.formData.password="000000",t.formData.createTime=p["a"].getNowFormatDateTime(),t.formData.status=t.persStatus[0].code)})):(this.resetFormData(),this.spinning=!1)}},computed:{title:function(){var e="新增";return"edit"===this.type&&(e="编辑"),"".concat(e,"人员")},imgUrl:function(){return"".concat(window.location.origin,"/").concat(window.ServiceConfig.fileUrl,"/").concat(this.formData.signFspath)}},methods:{uploadQm:function(){var e=this,t=document.createElement("input");t.type="file",t.accept="image/gif, image/jpeg, image/png",t.addEventListener("change",(function(){var a=t.files[0],r=new FormData;r.append("file",a),r.append("uploadClassify",""),r.append("uploadType","userSign");var n={userId:e.formData.id};r.append("param",JSON.stringify(n)),v()({method:"POST",headers:{"content-type":"multipart/form-data"},data:r,processData:!1,url:window.location.origin+"/diit-project/upload/uploadFile"}).then((function(t){e.getformInfo(),e.$message.success("上传成功")})).catch((function(t){e.$message.error("上传失败")}))})),t.click()},getformInfo:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.persService.getUserInfo({id:e.formData.id}).then((function(t){t.signFspath&&(e.formData=t)}));case 1:return t.a(2)}}),t)})))()},getPersStatus:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("YHZT");case 1:a=t.v,e.persStatus=a;case 2:return t.a(2)}}),t)})))()},getZw:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("ZW");case 1:a=t.v,e.zw=a;case 2:return t.a(2)}}),t)})))()},getZj:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("ZJ");case 1:a=t.v,e.zj=a;case 2:return t.a(2)}}),t)})))()},getSf:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("SF");case 1:a=t.v,e.sf=a;case 2:return t.a(2)}}),t)})))()},getGender:function(){var e=this;return Object(s["a"])(Object(i["a"])().m((function t(){var a;return Object(i["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getDictByCode("SEX");case 1:a=t.v,e.gender=a;case 2:return t.a(2)}}),t)})))()},resetFormData:function(){for(var e in this.$refs.form&&this.$refs.form.resetFields(),this.formData)this.formData[e]=""},handleOk:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.handleSubmit()}))},handleSubmit:function(){var e=this,t={};this.spinning=!0,"edit"===this.type?(t=this.formData,this.$bpmSystemProServices.persService.updatePers(t).then((function(t){t?(e.$message.success("保存成功"),e.$emit("submit",e.formData.id),e.$emit("update:visible",!1)):e.$message.error("保存失败")}))):(t.user=this.formData,this.$bpmSystemProServices.persService.commonPostRequest("/user/insert3",t).then((function(t){t?(e.$message.success("保存成功"),e.$emit("submit",e.formData.id),e.$emit("update:visible",!1)):e.$message.error("保存失败")})))},handleCancel:function(){this.$emit("update:visible",!1)}}},b=h,g=a("2877"),D=Object(g["a"])(b,r,n,!1,null,null,null);t["default"]=D.exports},d6a4:function(e,t,a){}}]);