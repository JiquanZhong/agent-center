(this["webpackJsonpMyLibrary"]=this["webpackJsonpMyLibrary"]||[]).push([["chunk-63e5fc68","chunk-5d821e7f","chunk-2d20ebc4"],{"1a1a":function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,visible:e.visible,okText:"确定",cancelText:"取消",centered:""},on:{"update:visible":function(t){e.visible=t},ok:e.handleOk,cancel:e.handleCancel}},[t("a-form-model",{ref:"form",attrs:{model:e.formData,rules:e.rules,layout:"horizontal","label-col":{span:4},"wrapper-col":{span:20}}},[t("a-form-model-item",{attrs:{label:"类别",prop:"typeId"}},[t("a-select",{staticStyle:{width:"200px","margin-right":"16px"},model:{value:e.formData.typeId,callback:function(t){e.$set(e.formData,"typeId",t)},expression:"formData.typeId"}},e._l(e.categories,(function(a){return t("a-select-option",{key:a.id,attrs:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])})),1),t("a-button",{attrs:{type:"primary"},on:{click:e.openCategories}},[e._v(" 类别管理 ")])],1),t("a-form-model-item",{attrs:{label:"代码",prop:"code"}},[t("a-input",{model:{value:e.formData.code,callback:function(t){e.$set(e.formData,"code",t)},expression:"formData.code"}})],1),t("a-form-model-item",{attrs:{label:"名称",prop:"name"}},[t("a-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),t("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[t("a-textarea",{attrs:{"auto-size":{minRows:3,maxRows:5}},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),t("CategoriesList",{attrs:{visible:e.categoriesVisible},on:{"update:visible":function(t){e.categoriesVisible=t}}})],1)},r=[],n=a("c14f"),o=a("1da1"),s=(a("4de4"),a("d3b7"),a("2930")),c={name:"AddDict",props:{visible:{type:Boolean,default:!1,required:!0},editData:{type:Object,required:!1,default:function(){return{}}},type:{type:String,required:!1,default:""}},created:function(){this.getCategories()},data:function(){var e=this;return{categoriesVisible:!1,categories:[],formData:{id:"",typeId:"",code:"",name:"",remark:""},rules:{code:[{validator:function(t,a,i){e.$bpmSystemProServices.systemService.validateDictCode({code:a,id:e.formData.id}).then((function(e){0!==e&&"0"!==e?i(new Error("请输入唯一标识")):i()}))},trigger:"blur"},{required:!0,message:"请输入唯一标识"}],name:[{required:!0,message:"请输入字典名称"}],typeId:[{required:!0,message:"请选择类别"}]}}},computed:{title:function(){var e="新增";return"edit"===this.type&&(e="编辑"),"".concat(e,"字典")}},watch:{visible:function(e){var t=this;e?this.$nextTick((function(){t.getCategories(),t.resetFormData(),"edit"===t.type&&(t.formData=Object.assign(t.formData,t.editData))})):this.resetFormData()},categoriesVisible:function(e){e||this.getCategories()}},methods:{getCategories:function(){var e=this;return Object(o["a"])(Object(n["a"])().m((function t(){var a;return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$bpmSystemProServices.systemService.getCategoriesList();case 1:a=t.v,e.categories=a;case 2:return t.a(2)}}),t)})))()},resetFormData:function(){for(var e in this.$refs.form&&this.$refs.form.resetFields(),this.formData)this.formData[e]="";var t=this.categories.filter((function(e){return"业务字典"===e.name}));t.length>0&&(this.formData.typeId=t[0].id)},handleOk:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.handleSubmit()}))},handleSubmit:function(){var e=this;this.$bpmSystemProServices.systemService.saveOrUpdateDict(this.formData).then((function(t){t?(e.$message.success("保存成功"),e.$emit("submit",e.formData.id)):e.$message.error("保存失败"),e.$emit("update:visible",!1)}))},handleCancel:function(){this.$emit("update:visible",!1)},openCategories:function(){this.categoriesVisible=!0}},components:{CategoriesList:s["default"]}},l=c,u=a("2877"),m=Object(u["a"])(l,i,r,!1,null,null,null);t["default"]=m.exports},2930:function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:"类别管理",visible:e.visible,centered:"",width:"700px",footer:null},on:{"update:visible":function(t){e.visible=t},cancel:e.handleCancel}},[t("SystemList",{ref:"categoriesList",attrs:{columns:e.categoryColumns,render:e.$bpmSystemProServices.systemService.getCategoriesList,params:e.categoryParams,buttons:e.categoryButtons,operations:e.operations}},[t("template",{slot:"search-box"},[t("a-form",{attrs:{layout:"inline"}},[t("a-form-item",[t("a-input-search",{attrs:{placeholder:"请输入类别名称","enter-button":""},on:{search:e.onSearch},model:{value:e.categoryParams.name,callback:function(t){e.$set(e.categoryParams,"name",t)},expression:"categoryParams.name"}})],1)],1)],1)],2),t("AddCategory",{attrs:{visible:e.addVisible,editData:e.editData,type:e.openType},on:{"update:visible":function(t){e.addVisible=t},"update:editData":function(t){e.editData=t},"update:edit-data":function(t){e.editData=t},submit:e.onCategorySubmit}})],1)},r=[],n=a("c14f"),o=a("1da1"),s=(a("d3b7"),a("d8b8")),c=a("b143"),l={name:"Categories",props:{visible:{type:Boolean,default:!1,required:!0}},data:function(){var e=this;return{categoryParams:{name:""},categoryColumns:[{title:"类别名称",dataIndex:"name",width:"60%",editable:!0},{title:"排序号",dataIndex:"sortNum",width:"20%",align:"center",editable:!0},{title:"操作",key:"action",width:"20%",align:"center",scopedSlots:{customRender:"action"}}],categoryButtons:[{id:1,text:"新增",icon:"iconfont-New",click:function(){e.editData={},e.openType="",e.addVisible=!0}},{id:2,text:"编辑",icon:"iconfont-Editor",click:function(){e.editData=e.$refs.categoriesList.getSelected(),e.editData?(e.openType="edit",e.addVisible=!0):e.$message.warning("请选择一条记录！")}}],operations:[{name:"删除",click:function(t,a){e.$confirm({title:"提示",content:"确定删除记录?",okText:"确认",cancelText:"取消",onOk:function(){e.$bpmSystemProServices.systemService.deleteCategory({id:t.id}).then((function(t){t?(e.$message.success("删除成功"),e.$refs.categoriesList.clearSelected(),e.onSearch()):e.$message.error("删除失败")}))},onCancel:function(){}})}}],openType:"",addVisible:!1,editData:{}}},methods:{onSearch:function(){var e=this;return Object(o["a"])(Object(n["a"])().m((function t(){return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:return t.a(2,new Promise(function(){var t=Object(o["a"])(Object(n["a"])().m((function t(a,i){return Object(n["a"])().w((function(t){while(1)switch(t.n){case 0:return t.n=1,e.$refs.categoriesList.getListData();case 1:a();case 2:return t.a(2)}}),t)})));return function(e,a){return t.apply(this,arguments)}}()))}}),t)})))()},handleCancel:function(){this.$emit("update:visible",!1)},onCategorySubmit:function(e){var t=this;return Object(o["a"])(Object(n["a"])().m((function a(){return Object(n["a"])().w((function(a){while(1)switch(a.n){case 0:return a.n=1,t.onSearch();case 1:e&&t.$refs.categoriesList.setSelectedRow(e);case 2:return a.a(2)}}),a)})))()}},components:{SystemList:s["a"],AddCategory:c["default"]}},u=l,m=a("2877"),d=Object(m["a"])(u,i,r,!1,null,null,null);t["default"]=d.exports},b143:function(e,t,a){"use strict";a.r(t);a("b0c0");var i=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{title:e.title,visible:e.visible,okText:"确定",cancelText:"取消",centered:""},on:{"update:visible":function(t){e.visible=t},ok:e.handleOk,cancel:e.handleCancel}},[t("a-form-model",{ref:"form",attrs:{model:e.formData,rules:e.rules,layout:"horizontal","label-col":{span:4},"wrapper-col":{span:20}}},[t("a-form-model-item",{attrs:{label:"类别名称",prop:"name"}},[t("a-input",{model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),t("a-form-model-item",{attrs:{label:"排序号",prop:"sortNum"}},[t("a-input-number",{model:{value:e.formData.sortNum,callback:function(t){e.$set(e.formData,"sortNum",t)},expression:"formData.sortNum"}})],1)],1)],1)},r=[],n={name:"AddDict",props:{visible:{type:Boolean,default:!1,required:!0},editData:{type:Object,required:!1,default:function(){return{}}},type:{type:String,required:!1,default:""}},data:function(){return{formData:{id:"",name:"",sortNum:""},rules:{name:[{required:!0,message:"请输入类别名称"}],sortNum:[{required:!0,message:"请输入排序号"}]}}},computed:{title:function(){var e="新增";return"edit"===this.type&&(e="编辑"),"".concat(e,"字典类别")}},watch:{visible:function(e){var t=this;e?this.$nextTick((function(){t.resetFormData(),"edit"===t.type&&(t.formData=Object.assign(t.formData,t.editData))})):this.resetFormData()}},methods:{resetFormData:function(){for(var e in this.$refs.form&&this.$refs.form.resetFields(),this.formData)this.formData[e]=""},handleOk:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.handleSubmit()}))},handleSubmit:function(){var e=this;this.$bpmSystemProServices.systemService.saveOrUpdateCategory(this.formData).then((function(t){t?(e.$message.success("保存成功"),e.$emit("submit",e.formData.id)):e.$message.error("保存失败"),e.$emit("update:visible",!1)}))},handleCancel:function(){this.$emit("update:visible",!1)}}},o=n,s=a("2877"),c=Object(s["a"])(o,i,r,!1,null,null,null);t["default"]=c.exports}}]);