(this["webpackJsonpMyLibrary"]=this["webpackJsonpMyLibrary"]||[]).push([["chunk-34e01a39"],{"260d":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"menus-container"},[t("SystemList",{ref:"menuList",attrs:{title:"菜单管理",columns:e.menuColumns,render:e.$bpmSystemProServices.systemService.getMenuList,buttons:e.menuButtons,scroll:{y:e.scrollY},pagination:!1,showAsTree:!0,defaultExpandAllRows:!0,expandIconColumnIndex:1},on:{rowClick:e.onRowClick,rowDbClick:e.onRowDbClick,datachange:e.getKey}}),t("AddMenu",{attrs:{visible:e.addVisible,editData:e.editData,type:e.openType,menus:e.menus},on:{"update:visible":function(t){e.addVisible=t},"update:editData":function(t){e.editData=t},"update:edit-data":function(t){e.editData=t},submit:e.onSearch}})],1)},r=[],c=n("c7eb"),s=n("1da1"),a=n("2909"),o=(n("99af"),n("4de4"),n("c740"),n("b64b"),n("d3b7"),n("159b"),n("d8b8")),u=n("a18c6"),d={name:"Menus",mounted:function(){},data:function(){var e=this;return{scrollY:null,menus:[],addVisible:!1,editData:{},openType:"",currentRow:{},changeRow:{},menuItem:{},menuColumns:[{title:"序号",customRender:function(e,t,n){return"".concat(n+1)},width:40,align:"center"},{title:"显示名称",dataIndex:"name",ellipsis:!0,width:120},{title:"配置名称",dataIndex:"confName",ellipsis:!0,width:120},{title:"菜单标识",dataIndex:"code",ellipsis:!0,width:80},{title:"菜单路径",dataIndex:"url",ellipsis:!0,width:300},{title:"顺序号",dataIndex:"sortNum",ellipsis:!0,width:50,align:"center"},{title:"菜单图标",dataIndex:"icon",ellipsis:!0,width:50,align:"center",scopedSlots:{customRender:"icon"}}],menuButtons:[{id:1,text:"新增",icon:"iconfont-New",click:function(){e.editData={pid:e.editData.id},e.openType="",e.menus=JSON.parse(JSON.stringify(e.$refs.menuList.getData())),e.addVisible=!0}},{id:2,text:"编辑",icon:"iconfont-Editor",click:function(){e.openType="edit",e.menus=JSON.parse(JSON.stringify(e.$refs.menuList.getData())),e.addVisible=!0}},{id:3,text:"删除",icon:"iconfont-Delete",click:function(){e.$confirm({title:"提示",content:"确定删除记录?",okText:"确认",cancelText:"取消",onOk:function(){e.$bpmSystemProServices.systemService.deleteMenu({resourceId:e.editData.id}).then((function(){e.onSearch()}))},onCancel:function(){}})}},{id:4,text:"上移",icon:"iconfont-up",click:function(){e.menuItem=e.$refs.menuList.getSelected()||{},0===Object.keys(e.menuItem).length&&e.$message.warning("请选择一条记录！");var t=e.$refs.menuList.getData(),n=[],i=null;if(e.menuItem.pid){var r=function(e){return e.forEach((function(t,n){t.children&&(e=[].concat(Object(a["a"])(e),Object(a["a"])(r(t.children))))})),e};n=r(t);var c=n.filter((function(t){return t.id===e.menuItem.pid})),s=c[0].children;if(i=s.findIndex((function(t){return t.id===e.menuItem.id})),0===i)return void e.$message.warning("不能上移");e.currentRow=e.menuItem,e.changeRow=s[i-1]}else{var o=t.findIndex((function(t){return t.id===e.menuItem.id}));if(0===o)return void e.$message.warning("不能上移");e.currentRow=e.menuItem,e.changeRow=t[o-1]}e.updateList("sy")}},{id:5,text:"下移",icon:"iconfont-down",click:function(){e.menuItem=e.$refs.menuList.getSelected()||{},0===Object.keys(e.menuItem).length&&e.$message.warning("请选择一条记录！");var t=e.$refs.menuList.getData(),n=[],i=null;if(e.menuItem.pid){var r=function(e){return e.forEach((function(t,n){t.children&&(e=[].concat(Object(a["a"])(e),Object(a["a"])(r(t.children))))})),e};n=r(t);var c=n.filter((function(t){return t.id===e.menuItem.pid})),s=c[0].children;if(i=s.findIndex((function(t){return t.id===e.menuItem.id})),i===s.length-1)return void e.$message.warning("不能下移");e.currentRow=e.menuItem,e.changeRow=s[i+1]}else{if(i=t.findIndex((function(t){return t.id===e.menuItem.id})),i===t.length-1)return void e.$message.warning("不能下移");e.currentRow=e.menuItem,e.changeRow=t[i+1]}e.updateList("xy")}},{id:6,text:"刷新",icon:"iconfont-Refresh",click:function(){e.onSearch()}}]}},provide:function(){return{getList:this.getList}},methods:{getScrollY:function(){var e=this;this.$nextTick((function(){var t=e.$refs.menuList.$el.querySelector(".ant-table-wrapper");e.scrollY=t.offsetHeight-50}))},getList:function(){return JSON.parse(JSON.stringify(this.$refs.menuList.getData()))},onSearch:function(){this.$refs.menuList.getListData()},onRowClick:function(e){this.editData=e},onRowDbClick:function(e){this.editData=e,this.menus=JSON.parse(JSON.stringify(this.$refs.menuList.getData())),this.openType="edit",this.addVisible=!0},updateList:function(e){var t=this;return Object(s["a"])(Object(c["a"])().mark((function n(){var i;return Object(c["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.currentRow.sortNum&&t.changeRow.sortNum){n.next=3;break}return"sy"===e?t.$message.error("选中的菜单和其上方的菜单的顺序号均不能为空！"):t.$message.error("选中的菜单和其下方的菜单的顺序号均不能为空！"),n.abrupt("return");case 3:i=t.currentRow.sortNum,t.currentRow.sortNum=t.changeRow.sortNum,t.changeRow.sortNum=i,t.$bpmSystemProServices.systemService.updateMenu(t.changeRow).then((function(e){e||t.$message.error("更新失败")})),t.$bpmSystemProServices.systemService.updateMenu(t.currentRow).then((function(e){e?t.onSearch():t.$message.error("更新失败")}));case 8:case"end":return n.stop()}}),n)})))()},getKey:function(){this.$refs.menuList.setSelectedRow(this.currentRow.id)}},created:function(){this.getScrollY()},components:{SystemList:o["a"],AddMenu:u["default"]}},l=d,m=(n("a5ef"),n("2877")),f=Object(m["a"])(l,i,r,!1,null,"8417a0be",null);t["default"]=f.exports},a5ef:function(e,t,n){"use strict";n("ccfc")},ccfc:function(e,t,n){}}]);